# OpenWan AWS éƒ¨ç½² - å½“å‰çŠ¶æ€å’Œåç»­æ­¥éª¤

**éƒ¨ç½²æ—¥æœŸ**: 2026-02-01  
**å½“å‰æ—¶é—´**: 2026-02-07 04:45  
**è´¦å·ID**: 843250590784  
**åŒºåŸŸ**: us-east-1

---

## âœ… å·²æˆåŠŸéƒ¨ç½²çš„èµ„æº

### 1. ç½‘ç»œåŸºç¡€è®¾æ–½ âœ…
- **VPC ID**: `vpc-0d13cba6e3a1eb22a`
- **ç»„ä»¶**:
  - Internet Gateway âœ…
  - NAT Gateway âœ… ($32/æœˆ)
  - å…¬æœ‰å­ç½‘ x1 âœ…
  - ç§æœ‰åº”ç”¨å­ç½‘ x1 âœ…
  - ç§æœ‰æ•°æ®å­ç½‘ x2 âœ…
  - è·¯ç”±è¡¨é…ç½® âœ…
  - DB Subnet Group âœ…
  - Cache Subnet Group âœ…

### 2. å­˜å‚¨æœåŠ¡ âœ…
- **S3å­˜å‚¨æ¡¶**: `openwan-media-843250590784`
- **é…ç½®**:
  - ç‰ˆæœ¬æ§åˆ¶: å·²å¯ç”¨ âœ…
  - åŠ å¯†: AES-256 âœ…
  - å…¬å…±è®¿é—®: å·²é˜»æ­¢ âœ…
- **æˆæœ¬**: ~$0.5/æœˆ

### 3. å¯†é’¥ç®¡ç† âœ…
- **Secrets Manager**: `openwan/database/password`
- **ARN**: `arn:aws:secretsmanager:us-east-1:843250590784:secret:openwan/database/password-xtcSIK`
- **åŒ…å«**: username (openwan) + password
- **æˆæœ¬**: $0.40/æœˆ

### 4. å®‰å…¨ç»„ âœ…
- **ALB Security Group**: `sg-001853d61bdb8c05c`
  - å…¥ç«™: HTTP(80) from 0.0.0.0/0
  
- **Backend Security Group**: `sg-0eaba9252d26c1edf`
  - å…¥ç«™: TCP(8080) from ALB SG
  
- **RDS Security Group**: `sg-095078eea4784c0b2`
  - å…¥ç«™: MySQL(3306) from Backend SG
  
- **Redis Security Group**: `sg-001dff883b935b1ab`
  - å…¥ç«™: Redis(6379) from Backend SG

### 5. æ¶ˆæ¯é˜Ÿåˆ— âœ…
- **SQSé˜Ÿåˆ—**: `openwan-test-transcoding`
- **URL**: `https://queue.amazonaws.com/843250590784/openwan-test-transcoding`
- **é…ç½®**:
  - æ¶ˆæ¯ä¿ç•™: 14å¤©
  - å¯è§æ€§è¶…æ—¶: 1å°æ—¶
  - é•¿è½®è¯¢: 20ç§’
- **æˆæœ¬**: ~$0.5/æœˆ

###6. ElastiCache Redis âœ…
- **é›†ç¾¤ID**: `openwan-test-redis`
- **çŠ¶æ€**: âœ… åˆ›å»ºä¸­ (çº¦5-10åˆ†é’Ÿ)
- **èŠ‚ç‚¹ç±»å‹**: cache.t3.micro
- **æˆæœ¬**: ~$12/æœˆ

---

## â³ å¾…åˆ›å»ºèµ„æº

### 7. RDS MySQLæ•°æ®åº“ â³
**é…ç½®**:
- å®ä¾‹æ ‡è¯†ç¬¦: openwan-test-db
- å®ä¾‹ç±»å‹: db.t3.small (2vCPU, 2GB RAM)
- å­˜å‚¨: 20GB gp3
- å¼•æ“: MySQL 8.0.35
- æ•°æ®åº“å: openwan_db
- ç”¨æˆ·å: openwan
- å¯†ç : (å·²å­˜å‚¨åœ¨Secrets Manager)
- Multi-AZ: å¦ (å•å®ä¾‹)
- å¤‡ä»½ä¿ç•™æœŸ: 7å¤©
- åŠ å¯†: å·²å¯ç”¨

**åˆ›å»ºå‘½ä»¤**:
```bash
./scripts/create-rds.sh
```

**é¢„è®¡æ—¶é—´**: 10-15åˆ†é’Ÿ  
**é¢„è®¡æˆæœ¬**: ~$25/æœˆ

### 8. åº”ç”¨éƒ¨ç½² (å¯é€‰) â³
**ç»„ä»¶**:
- ECRä»“åº“ (Backend + Worker)
- Dockeré•œåƒæ„å»ºå’Œæ¨é€
- ECS Fargateé›†ç¾¤
- ECSä»»åŠ¡å®šä¹‰ (Backend + Worker)
- ECSæœåŠ¡ (è‡ªåŠ¨æ‰©å±•)
- Application Load Balancer
- ç›®æ ‡ç»„å’Œç›‘å¬å™¨

**åˆ›å»ºå‘½ä»¤**:
```bash
./scripts/deploy-application-full.sh
```

**é¢„è®¡æ—¶é—´**: 15-20åˆ†é’Ÿ  
**é¢„è®¡æˆæœ¬**: ~$90/æœˆ

---

## ğŸ’° æˆæœ¬æ˜ç»†

### å½“å‰è¿è¡Œæˆæœ¬
| èµ„æº | é…ç½® | æœˆåº¦æˆæœ¬ | çŠ¶æ€ |
|------|------|---------|------|
| NAT Gateway | å•ä¸ª | $32.00 | âœ… è¿è¡Œ |
| S3 | ç©ºæ¡¶ | $0.50 | âœ… è¿è¡Œ |
| Secrets Manager | 1ä¸ªå¯†é’¥ | $0.40 | âœ… è¿è¡Œ |
| SQS | ä½ä½¿ç”¨ | $0.50 | âœ… è¿è¡Œ |
| ElastiCache | t3.micro | $12.00 | â³ åˆ›å»ºä¸­ |
| **å½“å‰å°è®¡** | | **$45.40/æœˆ** | |

### å¦‚æœåˆ›å»ºRDS
| èµ„æº | é…ç½® | æœˆåº¦æˆæœ¬ |
|------|------|---------|
| å½“å‰èµ„æº | - | $45.40 |
| RDS MySQL | t3.small | $25.00 |
| **å°è®¡** | | **$70.40/æœˆ** |

### å¦‚æœå®Œæ•´éƒ¨ç½²
| èµ„æº | é…ç½® | æœˆåº¦æˆæœ¬ |
|------|------|---------|
| å½“å‰+RDS | - | $70.40 |
| ECS Fargate | 2ä»»åŠ¡ | $70.00 |
| ALB | 1ä¸ª | $20.00 |
| **æ€»è®¡** | | **$160.40/æœˆ** |

---

## ğŸ“Š éƒ¨ç½²è¿›åº¦

```
æ€»è¿›åº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘ 70%

é˜¶æ®µ1: åŸºç¡€è®¾æ–½ âœ… 100%
  â”œâ”€ VPCå’Œç½‘ç»œ âœ…
  â”œâ”€ S3å­˜å‚¨ âœ…
  â”œâ”€ å®‰å…¨ç»„ âœ…
  â”œâ”€ SQSé˜Ÿåˆ— âœ…
  â””â”€ Secrets âœ…

é˜¶æ®µ2: æ•°æ®å±‚ â³ 50%
  â”œâ”€ Redis â³ åˆ›å»ºä¸­
  â””â”€ RDS â¬œ å¾…åˆ›å»º

é˜¶æ®µ3: åº”ç”¨å±‚ â¬œ 0%
  â”œâ”€ ECR â¬œ
  â”œâ”€ ECS â¬œ
  â””â”€ ALB â¬œ
```

---

## ğŸ¯ æ‚¨çš„é€‰æ‹©

### é€‰é¡¹A: ç»§ç»­åˆ›å»ºRDSï¼ˆæ¨èå®Œæˆæ•°æ®å±‚ï¼‰âœ…
**æ“ä½œ**:
```bash
cd /home/ec2-user/openwan
./scripts/create-rds.sh
```

**ç†ç”±**:
- âœ… å®Œæˆæ•°æ®å±‚ï¼Œå¯ä»¥æµ‹è¯•æ•°æ®åº“åŠŸèƒ½
- âœ… å¯ä»¥è¿è¡Œæ•°æ®åº“è¿ç§»
- âœ… å¯ä»¥æœ¬åœ°è¿æ¥äº‘ç«¯æ•°æ®åº“å¼€å‘
- âœ… å¢åŠ æˆæœ¬ä»…$25/æœˆ

**é¢„è®¡**: 10-15åˆ†é’Ÿåå®Œæˆ

---

### é€‰é¡¹B: å®Œæ•´éƒ¨ç½²ï¼ˆåŒ…å«åº”ç”¨ï¼‰
**æ“ä½œ**:
```bash
./scripts/deploy-complete.sh
```

**åŒ…å«**:
- åˆ›å»ºRDS
- åˆ›å»ºECRä»“åº“
- æ„å»ºDockeré•œåƒï¼ˆéœ€è¦Dockerè¿è¡Œï¼‰
- éƒ¨ç½²ECS Fargate
- åˆ›å»ºALB

**ç†ç”±**:
- âœ… ä¸€æ¬¡æ€§éƒ¨ç½²å®Œæ•´ç³»ç»Ÿ
- âœ… å¯ä»¥é€šè¿‡ALBè®¿é—®åº”ç”¨
- âœ… å®Œæ•´ä½“éªŒäº‘ç«¯æ¶æ„

**é™åˆ¶**:
- âš ï¸ éœ€è¦Dockerè¿è¡Œ
- âš ï¸ éœ€è¦æ„å»ºé•œåƒï¼ˆçº¦10åˆ†é’Ÿï¼‰
- âš ï¸ å¢åŠ æˆæœ¬$115/æœˆ

**é¢„è®¡**: 30-40åˆ†é’Ÿåå®Œæˆ

---

### é€‰é¡¹C: ä»…ä¿ç•™åŸºç¡€è®¾æ–½ï¼Œä¸åˆ›å»ºæ•°æ®åº“
**å½“å‰çŠ¶æ€**: ä¿æŒä¸å˜

**æœˆåº¦æˆæœ¬**: $45.40/æœˆ

**ç”¨é€”**:
- å­¦ä¹ AWSç½‘ç»œæ¶æ„
- ä¿ç•™åŸºç¡€è®¾æ–½ä¾›åç»­ä½¿ç”¨
- S3å¯ç”¨äºæ–‡ä»¶å­˜å‚¨æµ‹è¯•

---

### é€‰é¡¹D: æ¸…ç†æ‰€æœ‰èµ„æºï¼ˆåœæ­¢è®¡è´¹ï¼‰
**æ“ä½œ**:
```bash
./scripts/cleanup-all-resources.sh
```

**æ•ˆæœ**:
- åˆ é™¤æ‰€æœ‰å·²åˆ›å»ºèµ„æº
- åœæ­¢æ‰€æœ‰AWSè´¹ç”¨
- å¯ä»¥éšæ—¶é‡æ–°éƒ¨ç½²

---

## ğŸ”§ å®ç”¨è„šæœ¬

æˆ‘å·²ä¸ºæ‚¨åˆ›å»ºä»¥ä¸‹è„šæœ¬ï¼š

### åˆ›å»ºRDSè„šæœ¬
```bash
./scripts/create-rds.sh
```

### æµ‹è¯•Redisè¿æ¥
```bash
./scripts/test-redis-connection.sh
```

### è¿è¡Œæ•°æ®åº“è¿ç§»
```bash
./scripts/run-db-migration.sh
```

### æ¸…ç†èµ„æº
```bash
# ä»…æ¸…ç†æ•°æ®åº“
./scripts/cleanup-databases.sh

# æ¸…ç†æ‰€æœ‰èµ„æº
./scripts/cleanup-all-resources.sh
```

### æŸ¥çœ‹èµ„æºä¿¡æ¯
```bash
./scripts/show-deployment-info.sh
```

---

## ğŸ“ èµ„æºä¿¡æ¯æ–‡ä»¶

æ‰€æœ‰èµ„æºIDå·²ä¿å­˜åœ¨ï¼š
```
/tmp/vpc_id.txt          - VPC ID
/tmp/bucket_name.txt     - S3 Bucket
/tmp/alb_sg.txt          - ALB Security Group
/tmp/backend_sg.txt      - Backend Security Group
/tmp/rds_sg.txt          - RDS Security Group
/tmp/redis_sg.txt        - Redis Security Group
/tmp/queue_url.txt       - SQS Queue URL
```

å®Œæˆåè¿˜ä¼šæœ‰ï¼š
```
/tmp/rds_endpoint.txt    - RDS Endpoint
/tmp/redis_endpoint.txt  - Redis Endpoint
/tmp/alb_dns.txt         - ALB DNS Name
```

---

## ğŸ’¡ æˆ‘çš„å»ºè®®

åŸºäºå½“å‰è¿›åº¦ï¼Œæˆ‘å»ºè®®ï¼š

### ğŸ¯ æ¨èæ–¹æ¡ˆï¼šåˆ›å»ºRDSå®Œæˆæ•°æ®å±‚

**ç†ç”±**:
1. âœ… å·²ç»å®Œæˆ70%çš„å·¥ä½œ
2. âœ… Redisæ­£åœ¨åˆ›å»ºä¸­ï¼ŒåŠ ä¸ŠRDSå¯å®Œæˆæ•°æ®å±‚
3. âœ… ä»…éœ€å¢åŠ $25/æœˆï¼Œè·å¾—å®Œæ•´æ•°æ®åº“
4. âœ… å¯ä»¥æµ‹è¯•æ•°æ®åº“è¿ç§»å’Œåº”ç”¨è¿æ¥
5. âœ… å¦‚ä¸æ»¡æ„å¯éšæ—¶åˆ é™¤

**æ“ä½œæ­¥éª¤**:
```bash
# 1. åˆ›å»ºRDS
./scripts/create-rds.sh

# 2. ç­‰å¾…RDSå®Œæˆ (10-15åˆ†é’Ÿ)

# 3. è¿è¡Œæ•°æ®åº“è¿ç§»
./scripts/run-db-migration.sh

# 4. æµ‹è¯•è¿æ¥
./scripts/test-all-connections.sh

# 5. (å¯é€‰) éƒ¨ç½²åº”ç”¨
./scripts/deploy-application.sh
```

---

## â±ï¸ æ—¶é—´ä¼°ç®—

- **å½“å‰å·²è€—æ—¶**: çº¦10åˆ†é’Ÿ
- **Redisåˆ›å»ºä¸­**: å‰©ä½™çº¦5-8åˆ†é’Ÿ
- **åˆ›å»ºRDS**: 10-15åˆ†é’Ÿ
- **æ€»è®¡**: çº¦25-30åˆ†é’Ÿå®Œæˆæ•°æ®å±‚

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å‘Šè¯‰æˆ‘æ‚¨çš„é€‰æ‹©ï¼š
- **"åˆ›å»ºRDS"** - æˆ‘å°†åˆ›å»ºRDSæ•°æ®åº“
- **"å®Œæ•´éƒ¨ç½²"** - æˆ‘å°†éƒ¨ç½²åŒ…æ‹¬åº”ç”¨åœ¨å†…çš„æ‰€æœ‰èµ„æº
- **"ä¿æŒå½“å‰"** - ä¸å†åˆ›å»ºæ–°èµ„æº
- **"æ¸…ç†èµ„æº"** - åˆ é™¤æ‰€æœ‰å·²åˆ›å»ºèµ„æº

---

**å½“å‰çŠ¶æ€**: âœ… åŸºç¡€è®¾æ–½å®Œæˆï¼Œâ³ Redisåˆ›å»ºä¸­  
**ä¸‹ä¸€æ­¥**: ç­‰å¾…æ‚¨çš„å†³ç­–  
**æŠ¥å‘Šæ—¶é—´**: 2026-02-07 04:47:00
