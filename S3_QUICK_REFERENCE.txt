==============================================================
                 AWS S3 配置快速参考                         
==============================================================

S3 配置信息
--------------------------------------------------------------
  Bucket:     video-bucket-843250590784
  Region:     us-east-1
  Prefix:     openwan/
  Status:     配置成功，测试通过

启动命令
--------------------------------------------------------------
  # 方法 1: 前台运行
  source /tmp/s3_env.sh && /home/ec2-user/openwan/bin/openwan

  # 方法 2: 后台运行
  source /tmp/s3_env.sh && nohup /home/ec2-user/openwan/bin/openwan > /tmp/openwan_s3.log 2>&1 &

  # 方法 3: 使用启动脚本
  /home/ec2-user/openwan/start_with_s3.sh

验证命令
--------------------------------------------------------------
  # 检查进程
  ps aux | grep openwan | grep -v grep

  # 查看日志
  tail -f /tmp/openwan_s3.log

  # 验证 S3 存储
  tail /tmp/openwan_s3.log | grep "Storage:"

  # 列出 S3 文件
  aws s3 ls s3://video-bucket-843250590784/openwan/ --recursive

  # 测试 S3 功能
  cd /home/ec2-user/openwan && source /tmp/s3_env.sh && go run cmd/test-s3/main.go

配置文件
--------------------------------------------------------------
  主配置:     /home/ec2-user/openwan/configs/config.yaml
  环境变量:   /tmp/s3_env.sh
  启动脚本:   /home/ec2-user/openwan/start_with_s3.sh
  详细报告:   /home/ec2-user/openwan/S3_CONFIGURATION_REPORT.md

切换到本地存储
--------------------------------------------------------------
  1. 修改 configs/config.yaml: type: s3 -> type: local
  2. unset STORAGE_TYPE S3_BUCKET S3_REGION S3_PREFIX
  3. pkill -f openwan && /home/ec2-user/openwan/bin/openwan

测试结果
--------------------------------------------------------------
  [✓] 上传测试        通过
  [✓] 下载测试        通过
  [✓] 删除测试        通过
  [✓] 存在性检查      通过
  [✓] URL 生成        通过

S3 对象键格式
--------------------------------------------------------------
  格式: openwan/YYYY/MM/DD/filename
  示例: openwan/2026/02/06/test_upload.txt

有用链接
--------------------------------------------------------------
  S3 Console: https://s3.console.aws.amazon.com/s3/buckets/video-bucket-843250590784
  API Docs:   http://localhost:8080/api/v1/ping
  Health:     http://localhost:8080/health

==============================================================
